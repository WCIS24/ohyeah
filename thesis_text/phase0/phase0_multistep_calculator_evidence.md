# Multistep + Calculator ????????

Purpose:
- ??????????????????????? baseline ? multistep ? multistep+calculator ??????

How to use:
- ?????????? TODO ???????? outputs/<run_id>/metrics.json ? numeric_metrics.json?

## Multistep ?????configs/run_multistep.yaml?
- seed=42?top_k_each_step=5?max_steps=3?top_k_final=10?[EVIDENCE] configs/run_multistep.yaml:1-18
- ???? model_name=sentence-transformers/all-MiniLM-L6-v2?mode=dense?alpha=0.5?[EVIDENCE] configs/run_multistep.yaml:7-12

## Multistep ?????configs/eval_multistep.yaml?
- k_values=[1, 5, 10]?use_collected=true?[EVIDENCE] configs/eval_multistep.yaml:1-7
- baseline_metrics_path ?? outputs/20260128_192907_7a5655/metrics.json????? run_id ??????[EVIDENCE] configs/eval_multistep.yaml:1-7

## Calculator ????
- run_with_calculator?top_k=5?seed=42?use_multistep_results=false?output_percent=true?[EVIDENCE] configs/run_with_calculator.yaml:1-16
- eval_numeric?subset_qids_path=data/subsets/dev_numeric_qids.txt?precision=4?seed=42?[EVIDENCE] configs/eval_numeric.yaml:1-6

## ?????????
- ???????multistep_traces.jsonl?retrieval_results.jsonl?metrics.json?delta_vs_baseline.json?[EVIDENCE] README.md:109-113
- ??????facts.jsonl?results_R.jsonl?calc_traces.jsonl?predictions_calc.jsonl?numeric_metrics.json?[EVIDENCE] README.md:133-138
- ???? metrics.json ???? recall@k ? mrr@k?[EVIDENCE] scripts/eval_multistep_retrieval.py:169-177
- ???? numeric_metrics.json ?? numeric_em ????????[EVIDENCE] scripts/eval_numeric.py:216-234

## ?????run_id ???
- step6_experiments.yaml ??? baseline / multistep / calculator ?????? run_id ?????? outputs/<run_id>/summary.json??[EVIDENCE] configs/step6_experiments.yaml:1-13

## ??????????? README ???
- ? top_k_final < max(k_values)?Recall@k ????????README ??????? top_k_final >= max(k_values)?[EVIDENCE] README.md:114-116
- ??????? outputs/<run_id>/retrieval_results.jsonl ? final_top_chunks/collect_chunks ??????? k_values ???????????????????[EVIDENCE] README.md:109-116

## TODO??????
- TODO??? multistep ?? outputs/<run_id>/metrics.json ? delta_vs_baseline.json??? eval_multistep_retrieval??[EVIDENCE] README.md:100-113; scripts/eval_multistep_retrieval.py:179-198
- TODO??? calculator ? numeric_metrics.json ? numeric_per_query.jsonl??? eval_numeric??[EVIDENCE] README.md:124-138; scripts/eval_numeric.py:232-234
